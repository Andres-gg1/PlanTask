{% block navbar %}
<nav class="main-navbar">
  <div class="navbar-container">
    <a href="/" class="navbar-logo-link">
      <img src="{{ request.static_url('plantask:static/kochlogo.svg') }}" alt="Koch Company Logo" class="navbar-logo">
    </a>

    <button class="navbar-toggle-button" id="navbarToggle" aria-label="Toggle navigation">
      <span class="navbar-toggle-icon"></span>
    </button>
    <div class="navbar-content" id="navbarContent">
      <form class="navbar-search-form">
      <div class="navbar-search-container">
        <span class="navbar-search-icon" style="pointer-events: none; cursor: default;"><i class="bi bi-search"></i></span>
        <input class="navbar-search-input" type="search" placeholder="Search" aria-label="Search">
        <button class="navbar-search-button" type="submit" aria-label="Search Button">
        <i class="bi bi-caret-down-fill"></i>
        </button>
        </div>
      </form>
      <div class="navbar-icons">
        <a class="navbar-icon" href="#" title="Info"><i class="bi bi-question-circle"></i></a>
        <a id="pomodoroToggleBtn" class="navbar-icon" href="#" title="Hourglass">
          <i class="bi bi-hourglass-bottom"></i>
        </a>
        <a class="navbar-icon" href="#" title="Notifications"><i class="bi bi-bell"></i></a>
        <div class="navbar-icon dropdown">
          <a id="profileDropdown" aria-label="Profile" role="button"><i class="bi bi-circle-fill"></i></a>
          <div class="dropdown-menu dropdown-profile" id="profileDropdownMenu">
            <div class="dropdown-arrow"></div>
            <div class="dropdown-item profile-name"><strong>{{ user.first_name }} {{ user.last_name }}</strong></div>
            <div class="dropdown-item">@{{ user.username }}</div>
            <div class="dropdown-item">{{ user.email }}</div>
            <a class="dropdown-item logout-button" href="{{ request.route_url('logout') }}">
              Logout <i class="bi bi-box-arrow-right"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>
{% endblock %}

<script>
document.addEventListener('DOMContentLoaded', function () {
  const toggleBtn = document.getElementById('navbarToggle');
  const navbarContent = document.getElementById('navbarContent');
  const profileBtn = document.getElementById('profileDropdown');
  const profileMenu = document.getElementById('profileDropdownMenu');

  toggleBtn?.addEventListener('click', function (e) {
    e.preventDefault();
    navbarContent?.classList.toggle('show');
    
    const expanded = navbarContent?.classList.contains('show');
    toggleBtn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
  });

  profileBtn?.addEventListener('click', function (e) {
    e.preventDefault();
    profileMenu?.classList.toggle('show');

    if (profileMenu?.classList.contains('show')) {
      navbarContent?.classList.add('profile-open');
    } else {
      navbarContent?.classList.remove('profile-open');
    }
  });

  window.addEventListener('resize', function() {
    if (window.innerWidth > 992) { 
      navbarContent?.classList.remove('show');
    }
  });

  const pomodoroBtn = document.getElementById('pomodoroToggleBtn');
  const pomodoroWrapper = document.getElementById('pomodoro-wrapper');

  pomodoroBtn?.addEventListener('click', function (e) {
    e.preventDefault();
    pomodoroWrapper.classList.toggle('visible');
  });
});
</script>
